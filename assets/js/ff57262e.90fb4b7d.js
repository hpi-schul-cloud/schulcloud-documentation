"use strict";(self.webpackChunkdataport_docusaurus=self.webpackChunkdataport_docusaurus||[]).push([[8247],{3905:(e,t,r)=>{r.d(t,{Zo:()=>d,kt:()=>f});var o=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,o,n=function(e,t){if(null==e)return{};var r,o,n={},l=Object.keys(e);for(o=0;o<l.length;o++)r=l[o],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)r=l[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var i=o.createContext({}),u=function(e){var t=o.useContext(i),r=t;return e&&(r="function"==typeof e?e(t):a(a({},t),e)),r},d=function(e){var t=u(e.components);return o.createElement(i.Provider,{value:t},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},p=o.forwardRef((function(e,t){var r=e.components,n=e.mdxType,l=e.originalType,i=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),c=u(r),p=n,f=c["".concat(i,".").concat(p)]||c[p]||m[p]||l;return r?o.createElement(f,a(a({ref:t},d),{},{components:r})):o.createElement(f,a({ref:t},d))}));function f(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var l=r.length,a=new Array(l);a[0]=p;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s[c]="string"==typeof e?e:n,a[1]=s;for(var u=2;u<l;u++)a[u]=r[u];return o.createElement.apply(null,a)}return o.createElement.apply(null,r)}p.displayName="MDXCreateElement"},3792:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>i,contentTitle:()=>a,default:()=>m,frontMatter:()=>l,metadata:()=>s,toc:()=>u});var o=r(7462),n=(r(7294),r(3905));const l={},a="Implementation and usage of modules, submodule and barrel files in our project",s={unversionedId:"schulcloud-server/Coding-Guidelines/modules-submodules",id:"schulcloud-server/Coding-Guidelines/modules-submodules",title:"Implementation and usage of modules, submodule and barrel files in our project",description:"In this guide, we'll cover how to use modules, submodules and barrel files in our project. These concepts help you organize your code into separate files and directories, making it easier to manage and maintain.",source:"@site/docs/schulcloud-server/Coding-Guidelines/modules-submodules.md",sourceDirName:"schulcloud-server/Coding-Guidelines",slug:"/schulcloud-server/Coding-Guidelines/modules-submodules",permalink:"/docs/schulcloud-server/Coding-Guidelines/modules-submodules",draft:!1,editUrl:"https://github.com/hpi-schul-cloud/hpi-schul-cloud.github.io/blob/main/docs/schulcloud-server/Coding-Guidelines/modules-submodules.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Defining Entities",permalink:"/docs/schulcloud-server/Coding-Guidelines/micro-orm"},next:{title:"Repositories",permalink:"/docs/schulcloud-server/Coding-Guidelines/repositories"}},i={},u=[{value:"Modules and Submodules",id:"modules-and-submodules",level:2},{value:"Barrel Files",id:"barrel-files",level:2},{value:"Handling Circular Dependencies",id:"handling-circular-dependencies",level:2}],d={toc:u},c="wrapper";function m(e){let{components:t,...l}=e;return(0,n.kt)(c,(0,o.Z)({},d,l,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"implementation-and-usage-of-modules-submodule-and-barrel-files-in-our-project"},"Implementation and usage of modules, submodule and barrel files in our project"),(0,n.kt)("p",null,"In this guide, we'll cover how to use modules, submodules and barrel files in our project. These concepts help you organize your code into separate files and directories, making it easier to manage and maintain."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Module Structure",src:r(3374).Z,width:"1467",height:"2429"})),(0,n.kt)("h2",{id:"modules-and-submodules"},"Modules and Submodules"),(0,n.kt)("p",null,"In our project, modules are a way to create separate scopes. This means that interfaces, use cases, services, etc., declared in a module are not visible outside the module unless they are explicitly exported using the ",(0,n.kt)("inlineCode",{parentName:"p"},"export")," keyword. To import a module, you use the ",(0,n.kt)("inlineCode",{parentName:"p"},"import")," keyword followed by the module name. Here's an example:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-typescript"},"import { ModuleName } from '@modules/module-name';\n")),(0,n.kt)("p",null,"Submodules are modules that are part of a larger module. They should be used within the main module. If it is necessary to use parts of the submodule outside the main module, the main module should export this via its barrel file(index.ts):"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-typescript"},"// @modules/module-name/index.ts\nexport { SubmoduleServiceName } from './submodule-name/service.ts';\n")),(0,n.kt)("h2",{id:"barrel-files"},"Barrel Files"),(0,n.kt)("p",null,"Barrel files are a way to rollup exports from several folders into a single convenient nest-module. The barrel itself is a module file that re-exports selected exports of other submodules."),(0,n.kt)("p",null,"If you have several related service/interface files in a directory/module that should be publicly accessible, you can create a barrel file to export all these files from the main module again."),(0,n.kt)("p",null,"Here's an example of a barrel file:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-typescript"},"// @modules/module-name/index.ts\nexport { PublicService } from './services/public-service.ts';\nexport { ServiceInterfaceA, InterfaceB } from './interfaces';\nexport { InterfaceC } from './submodule-name/interfaces';\n")),(0,n.kt)("p",null,"!!! Please don't export everything from a module in the barrel file. Only export the public API of the module. This will make it easier to understand what the module provides and avoid unnecessary dependencies. And don't use wildcard exports like ",(0,n.kt)("inlineCode",{parentName:"p"},"export * from './services'")," in the barrel file."),(0,n.kt)("p",null,"And here's how you can import from the barrel:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-typescript"},"// @modules/other-module-name/service.ts\nimport { PublicService, InterfaceOfModule, InterfaceOfSubmodule } from '@modules/module-name';\n")),(0,n.kt)("h2",{id:"handling-circular-dependencies"},"Handling Circular Dependencies"),(0,n.kt)("p",null,"Circular dependencies occur when Module A depends on Module B, and Module B also depends on Module A. This can lead to unexpected behavior and hard-to-diagnose bugs."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Module Structure",src:r(6552).Z,width:"1285",height:"743"})),(0,n.kt)("p",null,"Here are some strategies to handle circular dependencies:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Refactor Your Code"),": The best way to handle circular dependencies is to refactor your code to remove them. This might involve moving some code to a new module to break the dependency cycle.")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-typescript"},"// @modules/moduleC/service.ts\nimport { PublicService, InterfaceOfModule, InterfaceOfSubmodule } from '@modules/moduleA';\nimport { PublicService, InterfaceOfModule, InterfaceOfSubmodule } from '@modules/moduleB';\n")),(0,n.kt)("ol",{start:2},(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Use Interfaces"),": If the circular dependency is due to types, you can use interfaces and type-only imports to break the cycle.")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-typescript"},"// @modules/moduleC/service.ts\nimport { type PublicService } from '@modules/moduleA';\nimport { type PublicService } from '@modules/moduleB';\n")),(0,n.kt)("ol",{start:3},(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Use Events"),": If you have a circular dependency between two modules that need to communicate with each other, consider using events to decouple them. This way, one module can emit an event that the other module listens to, without directly importing it.")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",{parentName:"p",href:"https://documentation.dbildungscloud.dev/docs/schulcloud-server/Coding-Guidelines/event-handling"},"https://documentation.dbildungscloud.dev/docs/schulcloud-server/Coding-Guidelines/event-handling"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",{parentName:"p",href:"https://docs.nestjs.com/recipes/cqrs"},"https://docs.nestjs.com/recipes/cqrs")))),(0,n.kt)("p",null,"Remember, circular dependencies are usually a sign of tightly coupled code and can lead to maintenance issues down the line. It's best to refactor your code to avoid them if possible."))}m.isMDXComponent=!0},3374:(e,t,r)=>{r.d(t,{Z:()=>o});const o=r.p+"assets/images/Modules-SubModules_background-87819f3982b86ea657a437c4ce27a1b4.svg"},6552:(e,t,r)=>{r.d(t,{Z:()=>o});const o=r.p+"assets/images/server_area_dependency_v2-7568982be5bb24f760fda6f031f1a887.svg"}}]);